{% extends "base.html" %}
{% block title %}Admin Dashboard{% endblock %}
{% block content %}

<link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">

<div class="container mt-5">
  <nav class="navbar navbar-expand-lg">
    <div class="container-fluid">
      <div class="collapse navbar-collapse justify-content-end">
        <ul class="navbar-nav">
          {% if current_user.is_authenticated and current_user.role == 'admin' %}
          <li class="nav-item d-flex align-items-center me-2">
            <span class="navbar-text">Welcome, Administrator!</span>
          </li>
          <li class="nav-item">
            <a class="btn btn-warning" href="{{ url_for('logout') }}">Logout</a>
          </li>
          {% else %}
          <li>
            <h1>You are not logged in.</h1>
          </li>
          {% endif %}
        </ul>
      </div>
    </div>
  </nav>

  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Admin Dashboard</h1>
  </div>

  <h2>Stocks in Market</h2>

  <!-- Flash messages -->
  {% with messages = get_flashed_messages() %}
    {% if messages %}
      <div class="alert alert-info">
        <ul>
          {% for message in messages %}
            <li>{{ message }}</li>
          {% endfor %}
        </ul>
      </div>
    {% endif %}
  {% endwith %}

  <table class="table table-bordered">
    <thead class="table-light">
      <tr>
        <th>Company Name</th>
        <th>Ticker</th>
        <th>Shares</th>
        <th>Current Market Price</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for stock in stock %}
      <tr>
        <td>{{ stock.stockName }}</td>
        <td>{{ stock.ticker }}</td>
        <td>{{ stock.quantity }}</td>
        <td>${{ "%.2f"|format(stock.currentMarketPrice) }}</td>
        <td>
          <a href="{{ url_for('edit_stock', id=stock.id) }}" class="btn btn-primary btn-sm">Edit</a>
          <a href="{{ url_for('delete_stock', id=stock.id) }}" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure you want to delete this stock?')">Delete</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  
  <div class="mt-4">
    <a class="btn btn-success" href="{{ url_for('add_stock') }}">Add Stock to Market</a>
    <a class="btn btn-secondary" href="{{ url_for('manage_markethours') }}">Manage Market Hours</a>
  </div>
</div>

{% endblock %}
